<!doctype html>
<html lang="es">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>5¬∫ La M√°quina del Tiempo | Formaci√≥n en Centros - Ceip Joaqu√≠n Tena Artigas </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="Ceip Joaqu√≠n Tena Artigas de Alcolea (C√≥rdoba)" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-sa/4.0/" />
<meta name="generator" content="eXeLearning 2.9 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body class="exe-web-site" id="exe-node-18"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Saltar la navegaci√≥n</a></p>
<header id="header" ><div id="headerContent">Formaci√≥n en Centros - Ceip Joaqu√≠n Tena Artigas</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">Inicio</a></li>
   <li><a href="formacin_en_centros_2425.html" class="daddy">Formaci√≥n en Centros 24-25</a>
   <ul class="other-section">
      <li><a href="itinerario_infantil.html" class="no-ch">Itinerario Infantil</a></li>
      <li><a href="itinerario_1_ciclo.html" class="no-ch">Itinerario 1¬∫ Ciclo</a></li>
      <li><a href="itinerario_2_ciclo.html" class="no-ch">Itinerario 2¬∫ Ciclo</a></li>
      <li><a href="itinerario_3_ciclo.html" class="no-ch">Itinerario 3¬∫ Ciclo</a></li>
   </ul>
   </li>
   <li class="current-page-parent"><a href="formacin_en_centros_2526.html" class="current-page-parent daddy">Formaci√≥n en Centros 25-26</a>
   <ul>
      <li><a href="infantil.html" class="no-ch">Infantil</a></li>
      <li><a href="1_razonamiento_matemtico.html" class="no-ch">1¬∫ Razonamiento matem√°tico</a></li>
      <li><a href="1_el_huerto_mgico.html" class="no-ch">1¬∫ El Huerto M√°gico</a></li>
      <li><a href="1_comprensin_lectora.html" class="daddy">1¬∫ Comprensi√≥n lectora</a>
      <ul class="other-section">
         <li><a href="1_comprensin_lectora__nivel_bajo.html" class="no-ch">1¬∫ Comprensi√≥n lectora - Nivel Bajo</a></li>
         <li><a href="1_comprensin_lectora__nivel_medio.html" class="no-ch">1¬∫ Comprensi√≥n lectora - Nivel Medio</a></li>
         <li><a href="1_comprensin_lectora__nivel_alto.html" class="no-ch">1¬∫ Comprensi√≥n lectora - Nivel Alto</a></li>
         <li><a href="lecturas_110.html" class="no-ch">Lecturas 1-10</a></li>
         <li><a href="lecturas_1120.html" class="no-ch">Lecturas 11-20</a></li>
         <li><a href="lecturas_2130.html" class="no-ch">Lecturas 21-30</a></li>
      </ul>
      </li>
      <li><a href="2_razonamiento_matemtico.html" class="no-ch">2¬∫ Razonamiento matem√°tico</a></li>
      <li><a href="2_viaje_a_marte.html" class="no-ch">2¬∫ Viaje a Marte</a></li>
      <li><a href="2_comprensin_lectora.html" class="daddy">2¬∫ Comprensi√≥n lectora</a>
      <ul class="other-section">
         <li><a href="2_lecturas__bloque_1.html" class="no-ch">2¬∫ Lecturas - Bloque 1</a></li>
         <li><a href="2_lecturas__bloque_2.html" class="no-ch">2¬∫ Lecturas - Bloque 2</a></li>
         <li><a href="2_lecturas__bloque_3.html" class="no-ch">2¬∫ Lecturas - Bloque 3</a></li>
         <li><a href="2_lecturas__bloque_4.html" class="no-ch">2¬∫ Lecturas - Bloque 4</a></li>
         <li><a href="2_lecturas__bloque_5.html" class="no-ch">2¬∫ Lecturas - Bloque 5</a></li>
         <li><a href="2_lecturas__bloque_6.html" class="no-ch">2¬∫ Lecturas - Bloque 6</a></li>
      </ul>
      </li>
      <li><a href="3_razonamiento_matemtico.html" class="no-ch">3¬∫ Razonamiento matem√°tico</a></li>
      <li><a href="seccin.html" class="no-ch">Secci√≥n</a></li>
      <li><a href="3_olimpiadas_robticas.html" class="no-ch">3¬∫ Olimpiadas rob√≥ticas</a></li>
      <li><a href="4_razonamiento_matemtico.html" class="no-ch">4¬∫ Razonamiento matem√°tico</a></li>
      <li><a href="4_aventura_submarina.html" class="no-ch">4¬∫ Aventura submarina</a></li>
      <li><a href="5_razonamiento_matemtico.html" class="no-ch">5¬∫ Razonamiento matem√°tico</a></li>
      <li id="active"><a href="5_la_mquina_del_tiempo.html" class="active no-ch">5¬∫ La M√°quina del Tiempo</a></li>
      <li><a href="6_razonamiento_matemtico.html" class="no-ch">6¬∫ Razonamiento matem√°tico</a></li>
      <li><a href="6_proyecto_final.html" class="no-ch">6¬∫ Proyecto final</a></li>
   </ul>
   </li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="5_razonamiento_matemtico.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="6_razonamiento_matemtico.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">5¬∫ La M√°quina del Tiempo</h1></header>
<article class="iDevice_wrapper textIdevice" id="id58">
<div class="iDevice emphasis0" >
<div id="ta58_141_2" class="block iDevice_content">
<div class="exe-text"><p></p>
<style>
    /* IMPORTACI√ìN DE FUENTES - Estilo Escolar */
    @font-face {
        font-family: 'Escolar';
        src: url('Escolar_G.TTF') format('truetype');
        font-weight: normal;
    }
    @font-face {
        font-family: 'Escolar';
        src: url('Escolar_N.TTF') format('truetype');
        font-weight: bold;
    }

    :root {
        /* Paleta Steampunk / Tiempo */
        --bg-time: #2c3e50; 
        --primary: #e67e22; /* Bronce */
        --secondary: #2980b9; /* Azul el√©ctrico */
        --accent: #f1c40f; /* Oro */
        --correct: #27ae60; 
        --wrong: #c0392b; 
        --text: #ecf0f1;
        --glass: rgba(44, 62, 80, 0.8);
    }

    * { box-sizing: border-box; user-select: none; }

    body {
        font-family: 'Escolar', 'Comic Sans MS', sans-serif;
        background-color: var(--bg-time);
        /* Fondo de engranajes abstracto */
        background-image: 
            radial-gradient(circle at 50% 50%, rgba(255,255,255,0.05) 0%, transparent 60%),
            repeating-conic-gradient(from 0deg, transparent 0deg 30deg, rgba(0,0,0,0.1) 30deg 60deg);
        margin: 0;
        padding: 20px;
        color: var(--text);
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
    }

    .game-container {
        width: 100%;
        max-width: 950px;
        min-height: 85vh;
        background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
        border-radius: 20px;
        border: 4px solid var(--primary);
        display: flex;
        flex-direction: column;
        position: relative;
        box-shadow: 0 0 50px rgba(230, 126, 34, 0.3);
        margin-bottom: 50px;
        overflow: hidden;
    }

    /* PANTALLAS */
    .screen {
        width: 100%; 
        min-height: 600px;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        padding: 20px;
        text-align: center;
        z-index: 2;
    }

    .screen.active {
        display: flex;
    }

    /* INICIO */
    h1 {
        font-size: 3.5rem;
        color: var(--accent);
        text-shadow: 2px 2px 0 #d35400;
        margin-bottom: 20px;
        line-height: 1.1;
        font-family: 'Escolar', serif;
        border-bottom: 3px solid var(--primary);
        padding-bottom: 10px;
    }

    .intro-text {
        font-size: 1.6rem;
        margin-bottom: 40px;
        color: #bdc3c7;
        line-height: 1.5;
        background: rgba(0,0,0,0.3);
        padding: 25px;
        border-radius: 15px;
        max-width: 700px;
    }

    .btn-start {
        background: linear-gradient(to bottom, #f39c12, #d35400);
        color: white;
        border: 2px solid #e67e22;
        padding: 20px 50px;
        font-size: 2rem;
        border-radius: 10px;
        font-family: 'Escolar', sans-serif;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 6px 0 #a04000;
        transition: transform 0.1s;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    .btn-start:active {
        transform: translateY(4px);
        box-shadow: 0 2px 0 #a04000;
    }

    /* JUEGO */
    .top-bar {
        width: 100%;
        display: flex;
        justify-content: space-between;
        padding: 15px 30px;
        font-size: 1.6rem;
        background: rgba(0,0,0,0.4);
        border-bottom: 2px solid var(--primary);
    }

    .score-box { color: var(--accent); font-weight: bold; }

    /* Barra de tiempo */
    .timer-bar-bg {
        width: 100%;
        height: 12px;
        background: rgba(255,255,255,0.1);
    }

    .timer-bar-fill {
        height: 100%;
        background: var(--correct);
        width: 100%;
        transition: width 1s linear;
    }

    .question-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 100%;
        padding: 20px;
    }

    .level-badge {
        background: var(--secondary);
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-size: 1rem;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .question-box {
        background: #ecf0f1;
        border-left: 6px solid var(--secondary);
        color: #2c3e50;
        padding: 25px;
        border-radius: 5px;
        margin-bottom: 30px;
        text-align: center;
        font-size: 1.8rem;
        width: 95%;
        line-height: 1.4;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    .grid-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        width: 95%;
        margin-bottom: 20px;
    }

    @media (max-width: 700px) {
        .grid-options { grid-template-columns: 1fr; }
        h1 { font-size: 2.5rem; }
        .question-box { font-size: 1.5rem; }
    }

    .option-btn {
        padding: 20px;
        font-size: 1.5rem;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-family: 'Escolar', sans-serif;
        font-weight: bold;
        color: white;
        transition: transform 0.1s;
        display: flex;
        align-items: center;
        justify-content: flex-start;
        text-align: left;
        position: relative;
        box-shadow: 0 5px 0 rgba(0,0,0,0.3);
        min-height: 80px;
        background-color: #34495e; 
        border: 1px solid rgba(255,255,255,0.1);
    }

    .option-btn:hover { background-color: #4b6584; }
    .option-btn:active { transform: translateY(4px); box-shadow: none; }

    /* Colores botones */
    .opt-0 { border-left: 5px solid #e74c3c; } 
    .opt-1 { border-left: 5px solid #3498db; } 
    .opt-2 { border-left: 5px solid #f1c40f; } 
    .opt-3 { border-left: 5px solid #2ecc71; } 

    .option-letter {
        font-size: 1.5rem;
        margin-right: 15px;
        background: rgba(0,0,0,0.3);
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-shrink: 0;
        font-weight: bold;
    }

    /* FEEDBACK FLOTANTE NEUTRO */
    .feedback-overlay {
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(44, 62, 80, 0.98);
        z-index: 100;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px;
        color: white;
    }

    .feedback-title { font-size: 3rem; margin-bottom: 20px; font-weight: bold; color: var(--accent); border-bottom: 2px solid white; padding-bottom: 10px;}
    .feedback-msg { font-size: 1.8rem; line-height: 1.5; max-width: 800px; background: rgba(255,255,255,0.1); padding: 30px; border-radius: 10px; }

    /* FINAL */
    .final-stats {
        background: rgba(0,0,0,0.2);
        border: 2px solid var(--accent);
        padding: 40px;
        border-radius: 15px;
        text-align: center;
        margin-bottom: 30px;
        width: 80%;
    }

</style>
<div class="game-container"><!-- PANTALLA 1: INICIO -->
<div id="screen-start" class="screen active">
<h1>üï∞Ô∏è LA M√ÅQUINA DEL TIEMPO</h1>
<p class="intro-text">Agente Temporal, la historia est√° desordenada.<br />Usa tus matem√°ticas de <strong>5¬∫ de Primaria</strong> para arreglarla.<br /><br /><strong>20 Desaf√≠os Hist√≥ricos</strong><br />‚è≥ 3 minutos para resolver cada paradoja.</p>
<button class="btn-start" onclick="startGame()">INICIAR VIAJE</button></div>
<!-- PANTALLA 2: JUEGO -->
<div id="screen-game" class="screen">
<div class="top-bar">
<div>Fase <span id="q-num">1</span> de 20</div>
<div class="score-box">Energ√≠a: <span id="score-val">0</span></div>
</div>
<div class="timer-bar-bg">
<div id="timer-bar" class="timer-bar-fill"></div>
</div>
<div class="question-container">
<div id="level-badge" class="level-badge">Nivel F√°cil</div>
<div class="question-box" id="question-text"><!-- Texto pregunta --></div>
<div class="grid-options" id="options-area"><!-- Botones se generan aqu√≠ --></div>
</div>
</div>
<!-- PANTALLA 3: FINAL -->
<div id="screen-end" class="screen">
<h1>üöÄ ¬°L√çNEA TEMPORAL SALVADA!</h1>
<div class="final-stats">
<p style="font-size: 2rem;">Puntuaci√≥n Total:</p>
<div style="font-size: 5rem; color: var(--accent); font-weight: bold; margin: 15px 0;" id="final-score">0</div>
<p style="font-size: 1.8rem;">¬°Eres un Guardi√°n del Tiempo!</p>
</div>
<button class="btn-start" onclick="location.reload()">Nuevo Viaje</button></div>
<!-- FEEDBACK OVERLAY -->
<div id="feedback-overlay" class="feedback-overlay">
<div class="feedback-title" id="fb-title">DATOS DE MISI√ìN</div>
<div class="feedback-msg" id="fb-msg">Mensaje...</div>
</div>
</div>
<p>
<script>
    // --- DATOS DEL JUEGO (5¬∫ PRIMARIA - 20 PREGUNTAS) ---
    
    const questions = [
        // NIVEL F√ÅCIL (1-7)
        {
            q: "üèõÔ∏è Roma: El Coliseo tiene capacidad para 50.000 personas. Si ya han entrado 12.450, ¬øcu√°ntas faltan por entrar?",
            opts: ["37.550", "38.550", "42.450", "37.650"],
            correct: 0,
            feedback: "Restamos lo que hay al total: 50.000 - 12.450 = 37.550 personas."
        },
        {
            q: "ü•ñ Edad Media: Un panadero vende 30 hogazas a 0,45 ‚Ç¨ cada una. ¬øCu√°nto dinero gana?",
            opts: ["13,50 ‚Ç¨", "12,50 ‚Ç¨", "135 ‚Ç¨", "1,35 ‚Ç¨"],
            correct: 0,
            feedback: "Multiplicamos decimales: 30 x 0,45 = 13,50 ‚Ç¨."
        },
        {
            q: "üß± Egipto: Una pir√°mide tiene una base cuadrada de 20 m de lado. ¬øCu√°l es su per√≠metro?",
            opts: ["40 m", "60 m", "80 m", "100 m"],
            correct: 2,
            feedback: "El cuadrado tiene 4 lados iguales. Per√≠metro = 20 x 4 = 80 m."
        },
        {
            q: "üß™ Laboratorio: Tenemos una probeta con 0,5 litros y otra con 25 cl. ¬øCu√°ntos centilitros hay en total?",
            opts: ["30 cl", "75 cl", "525 cl", "0,75 cl"],
            correct: 1,
            feedback: "0,5 litros son 50 cl. Sumamos 50 cl + 25 cl = 75 cl."
        },
        {
            q: "üçï Renacimiento: Leonardo come 2/8 de pizza y Miguel √Ångel come 3/8. ¬øQu√© fracci√≥n se han comido?",
            opts: ["5/16", "6/8", "5/8", "1/8"],
            correct: 2,
            feedback: "Suma de fracciones con igual denominador: 2+3 = 5. Resultado: 5/8."
        },
        {
            q: "üí∞ Futuro: Un robot cuesta 1.200 ‚Ç¨. Si pagas la mitad ahora y el resto despu√©s, ¬øcu√°nto pagas ahora?",
            opts: ["500 ‚Ç¨", "600 ‚Ç¨", "700 ‚Ç¨", "1.000 ‚Ç¨"],
            correct: 1,
            feedback: "La mitad de 1.200 es dividir entre 2: 1.200 : 2 = 600 ‚Ç¨."
        },
        {
            q: "‚è∞ Revoluci√≥n Industrial: Un tren sale a las 8:15 y llega a las 10:30. ¬øCu√°nto dura el viaje?",
            opts: ["2 h 15 min", "1 h 15 min", "2 h 30 min", "2 h 45 min"],
            correct: 0,
            feedback: "De 8:15 a 10:15 van 2 horas. Hasta las 10:30 faltan 15 min m√°s. Total: 2h 15min."
        },

        // NIVEL MEDIO (8-14)
        {
            q: "‚öñÔ∏è Mercado: Una sand√≠a pesa 3,5 kg. ¬øCu√°ntos gramos son?",
            opts: ["350 g", "3050 g", "3500 g", "35 g"],
            correct: 2,
            feedback: "1 kg son 1000 g. Multiplicamos 3,5 x 1000 = 3.500 gramos."
        },
        {
            q: "üìâ Oferta: Un libro vale 20 ‚Ç¨. Si tiene un descuento del 10%, ¬øcu√°nto me descuentan?",
            opts: ["10 ‚Ç¨", "5 ‚Ç¨", "2 ‚Ç¨", "1 ‚Ç¨"],
            correct: 2,
            feedback: "El 10% de 20 es dividir 20 entre 10. El descuento es 2 ‚Ç¨."
        },
        {
            q: "üìê Geometr√≠a: ¬øCu√°nto miden los 3 √°ngulos de un tri√°ngulo si los sumamos?",
            opts: ["90 grados", "180 grados", "360 grados", "100 grados"],
            correct: 1,
            feedback: "La suma de los √°ngulos interiores de cualquier tri√°ngulo siempre es 180¬∫."
        },
        {
            q: "üî¢ Series: 0,5 - 1,0 - 1,5 - 2,0... ¬øQu√© n√∫mero sigue?",
            opts: ["2,1", "3,0", "2,5", "2,05"],
            correct: 2,
            feedback: "La serie suma 0,5 cada vez. 2,0 + 0,5 = 2,5."
        },
        {
            q: "üç∞ Fracci√≥n de n√∫mero: En clase hay 24 alumnos. 1/3 llevan gafas. ¬øCu√°ntos llevan gafas?",
            opts: ["8 alumnos", "6 alumnos", "12 alumnos", "4 alumnos"],
            correct: 0,
            feedback: "Calculamos 1/3 de 24. Dividimos 24 entre 3 = 8."
        },
        {
            q: "üöú Campo: Un terreno rectangular mide 200 m de largo y 50 m de ancho. ¬øCu√°l es su √ÅREA?",
            opts: ["250 m¬≤", "1.000 m¬≤", "10.000 m¬≤", "500 m¬≤"],
            correct: 2,
            feedback: "√Årea del rect√°ngulo = base x altura. 200 x 50 = 10.000 m¬≤."
        },
        {
            q: "üßÆ Operaciones: Calcula: (20 + 5) x 4 - 10",
            opts: ["110", "90", "50", "60"],
            correct: 1,
            feedback: "Par√©ntesis primero: 25. Multiplicaci√≥n: 25x4=100. Resta: 100-10=90."
        },

        // NIVEL DIF√çCIL (15-20)
        {
            q: "üí∂ Dinero: Tengo 50 ‚Ç¨. Compro 3 libros a 12,50 ‚Ç¨ cada uno. ¬øCu√°nto me sobra?",
            opts: ["12,50 ‚Ç¨", "37,50 ‚Ç¨", "15 ‚Ç¨", "22,50 ‚Ç¨"],
            correct: 0,
            feedback: "Gasto: 12,50 x 3 = 37,50 ‚Ç¨. Sobra: 50 - 37,50 = 12,50 ‚Ç¨."
        },
        {
            q: "üèÉ Distancia: He recorrido 2 km y 5 dam. ¬øCu√°ntos metros son en total?",
            opts: ["2050 m", "2500 m", "2005 m", "250 m"],
            correct: 0,
            feedback: "2 km = 2000 m. 5 dam = 50 m. Total = 2050 m."
        },
        {
            q: "ü•ß Fracciones: ¬øQu√© es mayor? ¬ø3/5 o 4/10?",
            opts: ["3/5", "4/10", "Son iguales", "No se puede saber"],
            correct: 0,
            feedback: "Simplificamos o pasamos a decimal. 3/5 = 0,6. 4/10 = 0,4. Gana 3/5."
        },
        {
            q: "üïì Tiempo Complejo: Una pel√≠cula dura 135 minutos. ¬øCu√°ntas horas y minutos son?",
            opts: ["1h 35min", "2h 15min", "2h 35min", "1h 15min"],
            correct: 1,
            feedback: "1 hora = 60 min. 2 horas = 120 min. Sobran 15 min. Son 2h 15min."
        },
        {
            q: "üßë‚Äçü§ù‚Äçüßë L√≥gica: En una fila, Ana est√° la 4¬™ empezando por el principio y la 6¬™ empezando por el final. ¬øCu√°ntos hay?",
            opts: ["10", "9", "11", "8"],
            correct: 1,
            feedback: "Delante tiene 3 personas. Detr√°s tiene 5 personas. 3 + 5 + Ana = 9 personas."
        },
        {
            q: "üî¢ Decimales: 12,45 + 3,6 + 0,05 = ?",
            opts: ["15,10", "16,1", "16,05", "15,6"],
            correct: 1,
            feedback: "Alineamos las comas: 12,45 + 3,60 + 0,05 = 16,10."
        }
    ];

    // --- VARIABLES DE ESTADO ---
    let currentQIndex = 0;
    let score = 0;
    let timeLeft = 0;
    let timerInterval;
    const TIME_PER_QUESTION = 180; // 3 MINUTOS (180 seg)
    const POINTS_PER_QUESTION = 100; 

    // --- ELEMENTOS DOM ---
    const screens = {
        start: document.getElementById('screen-start'),
        game: document.getElementById('screen-game'),
        end: document.getElementById('screen-end')
    };
    
    const ui = {
        qNum: document.getElementById('q-num'),
        score: document.getElementById('score-val'),
        timerBar: document.getElementById('timer-bar'),
        qText: document.getElementById('question-text'),
        optsArea: document.getElementById('options-area'),
        fbOverlay: document.getElementById('feedback-overlay'),
        fbTitle: document.getElementById('fb-title'),
        fbMsg: document.getElementById('fb-msg'),
        finalScore: document.getElementById('final-score'),
        lvlBadge: document.getElementById('level-badge')
    };

    // --- FUNCIONES ---

    function showScreen(name) {
        Object.values(screens).forEach(s => {
            s.classList.remove('active');
            s.style.display = 'none';
        });
        const current = screens[name];
        current.style.display = 'flex';
        setTimeout(() => current.classList.add('active'), 10);
    }

    function startGame() {
        score = 0;
        currentQIndex = 0;
        showScreen('game');
        updateStats();
        loadQuestion();
    }

    function loadQuestion() {
        if (currentQIndex >= questions.length) {
            endGame();
            return;
        }

        const q = questions[currentQIndex];
        
        ui.qNum.innerText = currentQIndex + 1;
        ui.qText.innerText = q.q;
        ui.optsArea.innerHTML = '';
        
        // Badge Nivel
        if(currentQIndex < 7) {
            ui.lvlBadge.innerText = "Nivel: F√°cil";
            ui.lvlBadge.style.backgroundColor = "#27ae60";
        } else if(currentQIndex < 14) {
            ui.lvlBadge.innerText = "Nivel: Medio";
            ui.lvlBadge.style.backgroundColor = "#2980b9";
        } else {
            ui.lvlBadge.innerText = "Nivel: Dif√≠cil";
            ui.lvlBadge.style.backgroundColor = "#c0392b";
        }

        // Reset Timer
        timeLeft = TIME_PER_QUESTION;
        ui.timerBar.style.width = '100%';
        ui.timerBar.style.backgroundColor = '#27ae60'; 
        
        q.opts.forEach((optText, index) => {
            const btn = document.createElement('button');
            btn.className = `option-btn opt-${index}`;
            const letters = ['A', 'B', 'C', 'D'];
            btn.innerHTML = `<span class="option-letter">${letters[index]}</span> ${optText}`;
            btn.onclick = () => checkAnswer(index);
            ui.optsArea.appendChild(btn);
        });

        startTimer();
    }

    function startTimer() {
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft -= 1; 
            const percentage = (timeLeft / TIME_PER_QUESTION) * 100;
            ui.timerBar.style.width = `${percentage}%`;

            if (percentage < 20) ui.timerBar.style.backgroundColor = '#c0392b';

            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                showFeedback(false, "¬°Paradoja temporal! (Tiempo agotado) ‚è≥");
            }
        }, 1000);
    }

    function checkAnswer(selectedIndex) {
        clearInterval(timerInterval);
        const q = questions[currentQIndex];
        const isCorrect = selectedIndex === q.correct;

        if (isCorrect) {
            score += POINTS_PER_QUESTION;
            if(timeLeft > 100) score += 50; 
            showFeedback(true, q.feedback);
        } else {
            showFeedback(false, q.feedback);
        }
    }

    function showFeedback(isCorrect, msg) {
        ui.fbOverlay.style.display = 'flex';
        
        if (isCorrect) {
            ui.fbTitle.innerText = "¬°DATO CORRECTO!";
            ui.fbTitle.style.color = "var(--correct)";
        } else {
            ui.fbTitle.innerText = "AN√ÅLISIS"; 
            ui.fbTitle.style.color = "var(--primary)";
        }
        
        ui.fbMsg.innerText = msg;
        updateStats();

        setTimeout(() => {
            ui.fbOverlay.style.display = 'none';
            currentQIndex++;
            loadQuestion();
        }, 6000); 
    }

    function updateStats() {
        ui.score.innerText = score;
    }

    function endGame() {
        showScreen('end');
        ui.finalScore.innerText = score;
    }

</script>
</p></div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-sa">
<p><span>Obra publicada con</span> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Reconocimiento Compartir igual 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="5_razonamiento_matemtico.html" class="prev"><span><span>&laquo; </span>Anterior</span></a> <span class="sep">| </span><a href="6_razonamiento_matemtico.html" class="next"><span>Siguiente<span> &raquo;</span></span></a>
</nav>
</div>
</div>
<p id="made-with-eXe"><a href="https://exelearning.net/" target="_blank" rel="noopener"><span>Creado con eXeLearning<span> (Ventana nueva)</span></span></a></p><script type="text/javascript" src="_simplepoint_js.js"></script></body></html>